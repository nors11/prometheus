<div class="container-fluid">
    <div class="row">
        <nav class="col-md-3 col-lg-2 min-vh-100 p-0 d-md-block sidebar collapse bg-white">
            
            <div class="d-flex pt-4 pb-4">
                <a class="navbar-brand ms-5" [routerLink]="['/products']">
                    <img class="m-auto" src="assets/img/tecneplas-brand.svg" width="160">
                </a>
            </div>
            
            <div class="position-sticky pt-3">
                <ul class="nav flex-column">
                    <li class="nav-item">
                        <a class="nav-link p-0" aria-current="page" [ngClass]="{'tecneplas-current-page': currentWizardNumber === 0}">
                            <div class="pt-3 pb-3 ms-5">
                                1
                                <span class="text-secondary fw-bold fs-11 lh-2 ps-2 m-auto" i18n>General</span>
                            </div>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link p-0" [ngClass]="{'tecneplas-current-page': currentWizardNumber === 1}">
                            <div class="pt-3 pb-3 ms-5">
                                2
                                <span class="text-secondary fw-bold fs-11 lh-2 ps-2 m-auto" i18n>Servicios</span>
                            </div>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link p-0" [ngClass]="{'tecneplas-current-page': currentWizardNumber === 2}">
                            <div class="pt-3 pb-3 ms-5">
                                3
                                <span class="text-secondary fw-bold fs-11 lh-2 ps-2 m-auto" i18n>Secuencias</span>
                            </div>
                        </a>
                    </li>
                </ul>
            </div>
        </nav>
        <main class="col-md-9 ms-sm-auto col-lg-12">
            <div class="text-end m-4">
                <a class="text-primary" [routerLink]="['/product-models']">
                    <i class="bi bi-x-circle fs-1"></i>
                </a>
            </div>
            <div class="row">
                <div class="col-md-3"></div>
                <div class="col-md-6">
                    <div class="mt-5">
                        <!-- FORM -->
                        <form #modelNgForm="ngForm" [formGroup]="modelForm" (ngSubmit)="submitModelForm()">

                            <div *ngIf="currentWizardNumber === 0">
                                <h5 i18n>Nuevo modelo</h5>
                                <p class="fs-10" i18n>Para empezar, introduce los siguientes datos</p>
                            

                                <div class="row">
                                    <div class="col">
                                        <div class="mt-5 form-group">
                                            <label class="text-secondary fw-bold fs-11 lh-2" i18n>Nombre del modelo</label>
                                            <input type="text" class="form-control form-control-lg" required formControlName="name" [ngClass]="[modelNgForm.submitted && modelForm.controls.name.errors?.required ? 'is-invalid' : '']">
                                            <div class="invalid-feedback" *ngIf="modelForm.controls.name.errors?.required" i18n>Debe introducir un nombre</div>
                                        </div>
                                    </div>
                                </div>

                                <div class="row mt-4 mb-4">
                                    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-6 col-xl-6 col-xxl-6">
                                        <div class="form-group">
                                            <label class="text-secondary fw-bold fs-11 lh-2" i18n>Tipo de producto</label>
                                            <select class="form-select form-select-lg" aria-label="Tipo de producto" formControlName="type"  (change)="onProductTypeChange($event)">
                                                <option *ngFor="let productType of productTypes" [value]="productType.id">{{ productType.name }}</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-6 col-xl-6 col-xxl-6 mt-sm-4 mt-md-4 mt-lg-0 mt-xl-0 mt-xxl-0">
                                        <div class="form-group">
                                            <label class="text-secondary fw-bold fs-11 lh-2" i18n>Número de fuentes</label>
                                            <input type="number" min="1" step="1" class="form-control form-control-lg" required formControlName="sources" [ngClass]="[modelNgForm.submitted && modelForm.controls.sources.errors?.required ? 'is-invalid' : '']">
                                            <div class="invalid-feedback" *ngIf="modelForm.controls.sources.errors?.required" i18n>Debe introducir un número de fuentes</div>
                                        </div>
                                    </div>
                                </div>

                                <div class="row mt-4 mb-4">
                                    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-6 col-xl-6 col-xxl-6">
                                        <div class="form-group">
                                            <label class="text-secondary fw-bold fs-11 lh-2" i18n>¿Tiene orla?</label>
                                            <select class="form-select form-select-lg" aria-label="¿Tiene orla?" formControlName="fringe">
                                                <option *ngFor="let fringe of fringes" [value]="fringe.id">{{ fringe.name }}</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-6 col-xl-6 col-xxl-6">
                                        <div class="form-group">
                                            <label class="text-secondary fw-bold fs-11 lh-2" i18n>¿Es bicolor?</label>
                                            <select class="form-select form-select-lg" aria-label="Tipo de producto" formControlName="bicolor">
                                                <option [ngValue]="true">Si</option>
                                                <option [ngValue]="false">No</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <div class="row mt-4 mb-4">
                                    <div class="row mb-3 pe-0" formGroupName="top_panel" *ngIf="modelForm.controls.type.value =='cross'">
                                        <label class="col-sm-3 col-form-label text-secondary fw-bold fs-11 lh-2" i18n>Panel superior (N.º Leds)</label>
                                        <div class="col-sm-9 ps-0 pe-0">
                                            <div class="input-group mb-3 ">
                                                <input type="number" min="1" step="1" class="form-control" placeholder="ancho" formControlName="width" [ngClass]="[modelNgForm.submitted && (modelForm.controls.top_panel.controls.width.errors?.required || modelForm.controls.top_panel.controls.width.errors?.pattern) ? 'is-invalid' : '']">
                                                <div class="invalid-tooltip input-validation-radius" *ngIf="modelForm.controls.top_panel.controls.width.errors?.required" i18n>Debe introducir un número</div>
                                                <div class="invalid-tooltip input-validation-radius" *ngIf="modelForm.controls.top_panel.controls.width.errors?.pattern" i18n>Debe introducir un número entero</div>
                                                <span class="input-group-text text-secondary fw-bold fs-11 lh-2">x</span>
                                                <input type="number" min="1" step="1" class="form-control input-group-radius" placeholder="alto" formControlName="height" [ngClass]="[modelNgForm.submitted && (modelForm.controls.top_panel.controls.height.errors?.required || modelForm.controls.top_panel.controls.height.errors?.pattern) ? 'is-invalid' : '']">
                                                <div class="invalid-tooltip input-validation-radius" *ngIf="modelForm.controls.top_panel.controls.height.errors?.required" i18n>Debe introducir un número</div>
                                                <div class="invalid-tooltip input-validation-radius" *ngIf="modelForm.controls.top_panel.controls.height.errors?.pattern" i18n>Debe introducir un número entero</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mb-3 pe-0" formGroupName="central_panel">
                                        <label class="col-sm-3 col-form-label text-secondary fw-bold fs-11 lh-2" i18n>Panel central (N.º Leds)</label>
                                        <div class="col-sm-9 ps-0 pe-0">
                                            <div class="input-group flex-nowrap mb-3">
                                                <input type="number" min="1" step="1" class="form-control " placeholder="ancho" formControlName="width" [ngClass]="[modelNgForm.submitted && (modelForm.controls.central_panel.controls.width.errors?.required || modelForm.controls.central_panel.controls.width.errors?.pattern || modelForm.controls.central_panel.controls.width.errors?.min) ? 'is-invalid' : '']">
                                                <div class="invalid-tooltip input-validation-radius" *ngIf="modelForm.controls.central_panel.controls.height.errors?.min" i18n>Debe introducir un número mayor que 1</div>
                                                <div class="invalid-tooltip input-validation-radius" *ngIf="modelForm.controls.central_panel.controls.width.errors?.required" i18n>Debe introducir un número</div>
                                                <div class="invalid-tooltip input-validation-radius" *ngIf="modelForm.controls.central_panel.controls.width.errors?.pattern" i18n>Debe introducir un número entero</div>    
                                                <span class="input-group-text text-secondary fw-bold fs-11 lh-2">x</span>
                                                <input type="number" step="1" class="form-control input-group-radius" placeholder="alto" formControlName="height" [ngClass]="[modelNgForm.submitted && (modelForm.controls.central_panel.controls.height.errors?.required || modelForm.controls.central_panel.controls.height.errors?.pattern || modelForm.controls.central_panel.controls.height.errors?.min) ? 'is-invalid' : '']">
                                                <div class="invalid-tooltip input-validation-radius" *ngIf="modelForm.controls.central_panel.controls.height.errors?.min" i18n>Debe introducir un número mayor que 7</div>
                                                <div class="invalid-tooltip input-validation-radius" *ngIf="modelForm.controls.central_panel.controls.height.errors?.pattern" i18n>Debe introducir un número entero</div>
                                                <div class="invalid-tooltip input-validation-radius" *ngIf="modelForm.controls.central_panel.controls.height.errors?.required" i18n>Debe introducir un número</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mb-3 pe-0" formGroupName="bottom_panel" *ngIf="modelForm.controls.type.value =='cross'">
                                        <label class="col-sm-3 col-form-label text-secondary fw-bold fs-11 lh-2" i18n>Panel inferior (N.º Leds)</label>
                                        <div class="col-sm-9 ps-0 pe-0">
                                            <div class="input-group mb-3">
                                                <input type="number" min="1" step="1" class="form-control" placeholder="ancho" formControlName="width" [ngClass]="[modelNgForm.submitted && (modelForm.controls.bottom_panel.controls.width.errors?.required || modelForm.controls.bottom_panel.controls.width.errors?.pattern) ? 'is-invalid' : '']">
                                                <div class="invalid-tooltip input-validation-radius" *ngIf="modelForm.controls.bottom_panel.controls.width.errors?.required" i18n>Debe introducir un número</div>
                                                <div class="invalid-tooltip input-validation-radius" *ngIf="modelForm.controls.bottom_panel.controls.width.errors?.pattern" i18n>Debe introducir un número entero</div>
                                                <span class="input-group-text text-secondary fw-bold fs-11 lh-2">x</span>
                                                <input type="number" min="1" step="1" class="form-control input-group-radius" placeholder="alto" formControlName="height" [ngClass]="[modelNgForm.submitted && (modelForm.controls.bottom_panel.controls.height.errors?.required || modelForm.controls.bottom_panel.controls.height.errors?.pattern) ? 'is-invalid' : '']">
                                                <div class="invalid-tooltip input-validation-radius" *ngIf="modelForm.controls.bottom_panel.controls.height.errors?.required" i18n>Debe introducir un número</div>
                                                <div class="invalid-tooltip input-validation-radius" *ngIf="modelForm.controls.bottom_panel.controls.height.errors?.pattern" i18n>Debe introducir un número entero</div>
                                              </div>
                                        </div>
                                    </div>
                                </div>
                
                                <button class="mt-1 btn btn-lg btn-outline-primary me-2" disabled i18n>Atrás</button>
                                <button class="mt-1 btn btn-lg btn-primary" type="submit" i18n>Continuar</button>
                            
                            </div>
                    
                            <div *ngIf="currentWizardNumber === 1">
                                <h5 i18n>Servicios</h5>
                                <p class="fs-10" i18n>Selecciona los servicios que podrá utilizar el panel o la cruz.</p>
                                <div class="row">
                                    <div class="col-md-6 mb-3" *ngFor="let service of services">
                                        
                                        <div class="row rounded-2 bg-white shadow-lg cursor-pointer ms-2">
                                            <div class="row w-100 pt-3 pb-1">
                                                <div class="col-10">
                                                    <p class="fw-bold mb-1">{{ service?.name | typeAbbreviation }}</p>
                                                    <button type="button" class="btn btn-outline-primary mt-2 mb-2" (click)="openEditService(editServiceModal, service)">Editar</button>
                                                </div>
                                                <div class="col-2">
                                                    <svg *ngIf="service?.name == type.temperature" class="float-end" width="21" height="22" viewBox="0 0 21 22" fill="none"
                                                        xmlns="http://www.w3.org/2000/svg">
                                                        <path fill-rule="evenodd" clip-rule="evenodd"
                                                            d="M11.6773 2.53226C12.2385 2.53226 12.6934 2.07732 12.6934 1.51613C12.6934 0.954936 12.2385 0.5 11.6773 0.5C11.1161 0.5 10.6612 0.954936 10.6612 1.51613C10.6612 2.07732 11.1161 2.53226 11.6773 2.53226ZM17.0967 5.24191H17.4354C17.7947 5.24191 18.1393 5.38465 18.3934 5.63873C18.6475 5.89281 18.7902 6.23742 18.7902 6.59675H20.8225C20.8225 5.69843 20.4656 4.83691 19.8304 4.20171C19.1952 3.5665 18.3337 3.20965 17.4354 3.20965H17.0967C16.1983 3.20965 15.3368 3.5665 14.7016 4.20171C14.0664 4.83691 13.7096 5.69843 13.7096 6.59675V9.64513C13.7096 10.5434 14.0664 11.405 14.7016 12.0402C15.3368 12.6754 16.1983 13.0322 17.0967 13.0322H17.4354C18.3337 13.0322 19.1952 12.6754 19.8304 12.0402C20.4656 11.405 20.8225 10.5434 20.8225 9.64513H18.7902C18.7902 10.0045 18.6475 10.3491 18.3934 10.6031C18.1393 10.8572 17.7947 11 17.4354 11H17.0967C16.7373 11 16.3927 10.8572 16.1386 10.6031C15.8846 10.3491 15.7418 10.0045 15.7418 9.64513V6.59675C15.7418 6.23742 15.8846 5.89281 16.1386 5.63873C16.3927 5.38465 16.7373 5.24191 17.0967 5.24191ZM8.46161 20.604C7.61413 21.1875 6.60945 21.5 5.58052 21.5C4.55159 21.5 3.54691 21.1875 2.69943 20.604C1.85195 20.0205 1.20161 19.1934 0.834456 18.2322C0.467306 17.271 0.400653 16.221 0.643317 15.2211C0.885981 14.2212 1.42652 13.3185 2.19342 12.6326V5.24192C2.19342 4.34361 2.55027 3.48209 3.18548 2.84688C3.82068 2.21168 4.6822 1.85483 5.58052 1.85483C6.47883 1.85483 7.34035 2.21168 7.97556 2.84688C8.61076 3.48209 8.96761 4.34361 8.96761 5.24192V12.6326C9.73451 13.3185 10.2751 14.2212 10.5177 15.2211C10.7604 16.221 10.6937 17.271 10.3266 18.2322C9.95943 19.1934 9.30909 20.0205 8.46161 20.604ZM4.22568 5.24192V13.6927C3.6098 13.9983 3.11529 14.5031 2.82246 15.1251C2.52963 15.7471 2.45567 16.4499 2.6126 17.1193C2.76952 17.7886 3.14811 18.3853 3.68689 18.8124C4.22567 19.2395 4.893 19.4719 5.58052 19.4719C6.26803 19.4719 6.93536 19.2395 7.47414 18.8124C8.01292 18.3853 8.39151 17.7886 8.54844 17.1193C8.70536 16.4499 8.6314 15.7471 8.33857 15.1251C8.04574 14.5031 7.55124 13.9983 6.93536 13.6927V5.24192C6.93536 4.8826 6.79261 4.53799 6.53853 4.28391C6.28445 4.02982 5.93984 3.88708 5.58052 3.88708C5.22119 3.88708 4.87658 4.02982 4.6225 4.28391C4.36842 4.53799 4.22568 4.8826 4.22568 5.24192Z"
                                                            fill="#BAC0D9" />
                                                    </svg>
                                                    <svg *ngIf="service?.name == type.time" width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                        <path fill-rule="evenodd" clip-rule="evenodd" d="M10.9999 0.850098C16.6055 0.850098 21.1499 5.39441 21.1499 11.0001C21.1499 16.6058 16.6055 21.1501 10.9999 21.1501C5.39416 21.1501 0.849854 16.6058 0.849854 11.0001C0.849854 5.39441 5.39416 0.850098 10.9999 0.850098ZM10.9999 2.96828C6.564 2.96828 2.96804 6.56425 2.96804 11.0001C2.96804 15.4359 6.564 19.0319 10.9999 19.0319C15.4357 19.0319 19.0317 15.4359 19.0317 11.0001C19.0317 6.56425 15.4357 2.96828 10.9999 2.96828ZM10.9999 4.48646C11.5458 4.48646 11.9952 4.89952 12.0527 5.43015L12.0589 5.54555L12.0589 10.5611L14.476 12.9785C14.826 13.3285 14.8798 13.8624 14.6375 14.269L14.5641 14.3765L14.476 14.4763C14.0942 14.858 13.4935 14.8874 13.078 14.5644L12.9782 14.4763L10.251 11.749C10.0807 11.5787 9.97442 11.3565 9.94752 11.1196L9.94076 11.0001V5.54555C9.94076 4.96063 10.4149 4.48646 10.9999 4.48646Z" fill="#BAC0D9"/>
                                                    </svg>
                                                    <svg *ngIf="service?.name == type.date" width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                        <path fill-rule="evenodd" clip-rule="evenodd" d="M14.8386 0.199951C16.5843 0.199951 18.0233 1.61539 17.9997 3.3847V14.6611C17.9997 16.4068 16.5607 17.8458 14.815 17.8458H3.18475C1.43903 17.8458 0 16.4068 0 14.6611V3.3847C0 1.63898 1.43903 0.199951 3.18475 0.199951H14.8386ZM16.3484 6.59304H1.65135V14.6611C1.65135 15.5103 2.33548 16.1945 3.18475 16.1945H14.8386C15.6878 16.1945 16.372 15.5103 16.3484 14.6611V6.59304ZM9.0644 12.9496L9.17679 12.9625C9.24756 12.9625 9.29474 12.9861 9.34192 13.0097C9.3891 13.0333 9.43629 13.0569 9.48347 13.0805C9.53065 13.1041 9.55424 13.1277 9.60142 13.1748C9.62501 13.1984 9.67219 13.2456 9.69578 13.2928C9.71937 13.34 9.74296 13.3872 9.76655 13.4343C9.79015 13.4815 9.81374 13.5287 9.81374 13.6231C9.83733 13.6702 9.83733 13.741 9.83733 13.7882C9.83733 14.0005 9.76656 14.2128 9.60142 14.378C9.57783 14.4016 9.53065 14.4487 9.48347 14.4723C9.43629 14.4959 9.3891 14.5195 9.34192 14.5431C9.29474 14.5667 9.22397 14.5903 9.17679 14.5903C9.12961 14.6139 9.05883 14.6139 9.01165 14.6139C8.79934 14.6139 8.58702 14.5431 8.42188 14.378C8.39829 14.3544 8.35111 14.3072 8.32752 14.26C8.30393 14.2128 8.28034 14.1657 8.25675 14.1185C8.23316 14.0713 8.20957 14.0005 8.20957 13.9533C8.18598 13.9062 8.18598 13.8354 8.18598 13.7882C8.18598 13.741 8.20957 13.6702 8.20957 13.6231C8.20957 13.5523 8.23316 13.5051 8.25675 13.4579C8.28034 13.4108 8.30393 13.3636 8.32752 13.3164C8.35111 13.2692 8.3747 13.2456 8.42188 13.1984C8.6342 12.9861 8.91729 12.9153 9.17679 12.9625L9.0644 12.9496ZM3.70374 13.1513C4.01042 12.8446 4.5766 12.8446 4.88328 13.1513C5.02482 13.3164 5.11918 13.5051 5.11918 13.741C5.11918 13.9769 5.04841 14.1657 4.88328 14.3308C4.71814 14.4723 4.50583 14.5667 4.29351 14.5667C4.08119 14.5667 3.86888 14.4959 3.70374 14.3308C3.5622 14.1657 3.46783 13.9533 3.46783 13.741C3.46783 13.6938 3.49143 13.6231 3.49143 13.5759L3.49842 13.5121C3.50715 13.4737 3.52288 13.4422 3.53861 13.4108C3.5622 13.3636 3.58579 13.3164 3.60938 13.2692C3.63297 13.222 3.65656 13.1984 3.70374 13.1513ZM6.48745 12.9389C6.77053 12.8682 7.05362 12.9625 7.24235 13.1513C7.38389 13.3164 7.47826 13.5287 7.47826 13.741C7.47826 13.7882 7.45467 13.859 7.45467 13.9062L7.44768 13.9699C7.43894 14.0084 7.42321 14.0398 7.40748 14.0713C7.38389 14.1185 7.3603 14.1657 7.33671 14.2128C7.31312 14.26 7.28953 14.2836 7.24235 14.3308C7.07721 14.4723 6.8649 14.5667 6.65258 14.5667C6.6054 14.5667 6.53463 14.5431 6.48745 14.5431C6.41667 14.5431 6.36949 14.5195 6.32231 14.4959L6.18077 14.4252C6.13359 14.4016 6.10999 14.378 6.06281 14.3308C6.03922 14.3072 5.99204 14.26 5.96845 14.2128C5.94486 14.1657 5.92127 14.1185 5.89768 14.0713C5.87409 14.0241 5.8505 13.9533 5.8505 13.9062C5.82691 13.859 5.82691 13.7882 5.82691 13.741C5.82691 13.5051 5.92127 13.2928 6.06281 13.1513C6.0864 13.1277 6.13359 13.0805 6.18077 13.0569C6.22795 13.0333 6.25154 13.0097 6.32231 12.9861C6.39308 12.9625 6.44026 12.9389 6.48745 12.9389ZM11.2056 12.9389C11.4887 12.8682 11.7718 12.9625 11.9605 13.1513C12.102 13.3164 12.1964 13.5287 12.1964 13.741C12.1964 13.7882 12.1728 13.859 12.1728 13.9062L12.1658 13.9699C12.1571 14.0084 12.1414 14.0398 12.1256 14.0713C12.102 14.1185 12.0784 14.1657 12.0549 14.2128C12.0313 14.26 12.0077 14.2836 11.9605 14.3308C11.7954 14.4723 11.6066 14.5667 11.3707 14.5667C11.1348 14.5667 10.9225 14.4959 10.781 14.3308C10.7574 14.3072 10.7102 14.26 10.6866 14.2128C10.663 14.1657 10.6394 14.1185 10.6158 14.0713C10.5922 14.0241 10.5686 13.9533 10.5686 13.9062C10.545 13.859 10.545 13.7882 10.545 13.741C10.545 13.5051 10.6394 13.2928 10.781 13.1513C10.8045 13.1277 10.8517 13.0805 10.8989 13.0569L11.0405 12.9861C11.1112 12.9625 11.1584 12.9389 11.2056 12.9389ZM9.0644 10.5905L9.17679 10.6035C9.24756 10.6035 9.29474 10.627 9.34192 10.6506C9.3891 10.6742 9.43629 10.6978 9.48347 10.7214C9.53065 10.745 9.55424 10.7686 9.60142 10.8158C9.62501 10.8394 9.67219 10.8865 9.69578 10.9337C9.71937 10.9809 9.74296 11.0281 9.76655 11.0753C9.79015 11.1225 9.81374 11.1696 9.81374 11.264C9.83733 11.3112 9.83733 11.382 9.83733 11.4291C9.83733 11.4763 9.81374 11.5471 9.81374 11.5943C9.81374 11.665 9.79015 11.7122 9.76655 11.7594C9.74296 11.8066 9.71937 11.8538 9.69578 11.9009C9.67219 11.9481 9.6486 11.9717 9.60142 12.0189C9.57783 12.0425 9.53065 12.0897 9.48347 12.1133C9.43629 12.1369 9.3891 12.1604 9.34192 12.184C9.29474 12.2076 9.22397 12.2312 9.17679 12.2312C9.12961 12.2548 9.05883 12.2548 9.01165 12.2548C8.79934 12.2548 8.58702 12.184 8.42188 12.0189C8.39829 11.9953 8.35111 11.9481 8.32752 11.9009C8.30393 11.8538 8.28034 11.8066 8.25675 11.7594C8.23316 11.7122 8.20957 11.6414 8.20957 11.5943C8.18598 11.5471 8.18598 11.4763 8.18598 11.4291C8.18598 11.382 8.20957 11.3112 8.20957 11.264C8.20957 11.1932 8.23316 11.146 8.25675 11.0989C8.28034 11.0517 8.30393 11.0045 8.32752 10.9573C8.35111 10.9101 8.3747 10.8865 8.42188 10.8394C8.6342 10.627 8.91729 10.5563 9.17679 10.6035L9.0644 10.5905ZM13.14 10.8158C13.4703 10.5091 14.0129 10.5091 14.3196 10.8158C14.3432 10.8394 14.3903 10.8865 14.4139 10.9337C14.4375 10.9809 14.4611 11.0281 14.4847 11.0753C14.5083 11.1225 14.5319 11.1696 14.5319 11.2404C14.5555 11.2876 14.5555 11.3584 14.5555 11.4055C14.5555 11.6414 14.4847 11.8302 14.3196 11.9953C14.1544 12.1369 13.9657 12.2312 13.7298 12.2312C13.4939 12.2312 13.2816 12.1604 13.14 11.9953C12.9985 11.8302 12.9041 11.6414 12.9041 11.4055C12.9041 11.1696 12.9985 10.9573 13.14 10.8158ZM4.12837 10.5799C4.41146 10.5091 4.69455 10.6035 4.88328 10.7922C5.02482 10.9573 5.11918 11.1696 5.11918 11.382C5.11918 11.4291 5.09559 11.4999 5.09559 11.5471L5.0886 11.6109C5.07987 11.6493 5.06414 11.6808 5.04841 11.7122C5.02482 11.7594 5.00123 11.8066 4.97764 11.8538C4.95405 11.9009 4.93046 11.9245 4.88328 11.9717C4.71814 12.1133 4.50583 12.2076 4.29351 12.2076C4.24633 12.2076 4.17556 12.184 4.12837 12.184C4.0576 12.184 4.01042 12.1604 3.96324 12.1369L3.8217 12.0661C3.77451 12.0425 3.75092 12.0189 3.70374 11.9717C3.68015 11.9481 3.63297 11.9009 3.60938 11.8538C3.58579 11.8066 3.5622 11.7594 3.53861 11.7122C3.51502 11.665 3.49143 11.5943 3.49143 11.5471C3.46783 11.4999 3.46783 11.4291 3.46783 11.382C3.46783 11.146 3.5622 10.9337 3.70374 10.7922C3.72733 10.7686 3.77451 10.7214 3.8217 10.6978C3.86888 10.6742 3.89247 10.6506 3.96324 10.627C4.03401 10.6035 4.08119 10.5799 4.12837 10.5799ZM6.48745 10.5799C6.77053 10.5091 7.05362 10.6035 7.24235 10.7922C7.38389 10.9573 7.47826 11.146 7.47826 11.382C7.47826 11.6179 7.40748 11.8066 7.24235 11.9717C7.07721 12.1133 6.8649 12.2076 6.65258 12.2076C6.6054 12.2076 6.53463 12.184 6.48745 12.184C6.41667 12.184 6.36949 12.1604 6.32231 12.1369L6.18077 12.0661C6.13359 12.0425 6.10999 12.0189 6.06281 11.9717C6.03922 11.9481 5.99204 11.9009 5.96845 11.8538C5.94486 11.8066 5.92127 11.7594 5.89768 11.7122C5.87409 11.665 5.8505 11.5943 5.8505 11.5471C5.82691 11.4999 5.82691 11.4291 5.82691 11.382C5.82691 11.3348 5.8505 11.264 5.8505 11.2168L5.85749 11.153C5.86622 11.1146 5.88195 11.0831 5.89768 11.0517C5.92127 11.0045 5.94486 10.9573 5.96845 10.9101C5.99204 10.863 6.01563 10.8394 6.06281 10.7922C6.0864 10.7686 6.13359 10.7214 6.18077 10.6978L6.32231 10.627C6.39308 10.6035 6.44026 10.5799 6.48745 10.5799ZM11.2056 10.5799C11.4887 10.5091 11.7718 10.6035 11.9605 10.7922C12.102 10.9573 12.1964 11.146 12.1964 11.382C12.1964 11.6179 12.1256 11.8066 11.9605 11.9717C11.7954 12.1133 11.6066 12.2076 11.3707 12.2076C11.1348 12.2076 10.9225 12.1369 10.781 11.9717C10.6394 11.8066 10.545 11.6179 10.545 11.382C10.545 11.146 10.6394 10.9337 10.781 10.7922C10.8045 10.7686 10.8517 10.7214 10.8989 10.6978C10.9461 10.6742 10.9697 10.6506 11.0405 10.627C11.1112 10.6035 11.1584 10.5799 11.2056 10.5799ZM9.04081 8.20786L9.1532 8.22079C9.22397 8.22079 9.27115 8.24438 9.31833 8.26798C9.36551 8.29157 9.41269 8.31516 9.45988 8.33875C9.50706 8.36234 9.55424 8.40952 9.57783 8.4567C9.71937 8.62184 9.81374 8.83415 9.81374 9.04647C9.81374 9.09365 9.79015 9.16442 9.79015 9.21161C9.79015 9.28238 9.76656 9.32956 9.74296 9.37674L9.67219 9.51828C9.6486 9.56547 9.62501 9.58906 9.57783 9.63624C9.55424 9.65983 9.50706 9.70701 9.45988 9.7306C9.41269 9.75419 9.36551 9.77778 9.31833 9.80137C9.27115 9.82496 9.20038 9.84855 9.1532 9.84855C9.10602 9.87214 9.03524 9.87214 8.98806 9.87214C8.77575 9.87214 8.56343 9.80137 8.39829 9.63624C8.3747 9.61265 8.32752 9.56547 8.30393 9.51828L8.23316 9.37674C8.20957 9.32956 8.18598 9.25879 8.18598 9.21161C8.16239 9.16442 8.16239 9.09365 8.16239 9.04647C8.16239 8.83415 8.25675 8.62184 8.39829 8.4567C8.61061 8.24439 8.8937 8.17361 9.1532 8.22079L9.04081 8.20786ZM6.48745 8.22079C6.77053 8.15002 7.05362 8.24439 7.24235 8.43311C7.38389 8.59825 7.47826 8.81056 7.47826 9.02288C7.47826 9.2352 7.40748 9.44751 7.24235 9.61265C7.21876 9.63624 7.17158 9.68342 7.1244 9.70701L6.98285 9.77778C6.93567 9.80137 6.8649 9.82496 6.81772 9.82496C6.77053 9.84855 6.69976 9.84855 6.65258 9.84855C6.44026 9.84855 6.22795 9.77778 6.06281 9.61265C5.92127 9.44751 5.82691 9.2352 5.82691 9.02288C5.82691 8.9757 5.8505 8.90493 5.8505 8.85774L5.85749 8.79396C5.86622 8.75552 5.88195 8.72406 5.89768 8.69261C5.92127 8.64543 5.94486 8.59825 5.96845 8.55106C5.99204 8.50388 6.01563 8.48029 6.06281 8.43311C6.0864 8.40952 6.13359 8.36234 6.18077 8.33875L6.32231 8.26798C6.39308 8.24438 6.44026 8.22079 6.48745 8.22079ZM11.2056 8.22079C11.4887 8.15002 11.7718 8.24439 11.9605 8.43311C12.102 8.59825 12.1964 8.81056 12.1964 9.02288C12.1964 9.07006 12.1728 9.14083 12.1728 9.18801L12.1658 9.2518C12.1571 9.29024 12.1414 9.32169 12.1256 9.35315C12.102 9.40033 12.0784 9.44751 12.0549 9.49469C12.0313 9.54187 12.0077 9.56547 11.9605 9.61265C11.9369 9.63624 11.8897 9.68342 11.8425 9.70701L11.701 9.77778C11.6538 9.80137 11.583 9.82496 11.5359 9.82496C11.4887 9.84855 11.4179 9.84855 11.3707 9.84855C11.1348 9.84855 10.9225 9.77778 10.781 9.61265C10.7574 9.58906 10.7102 9.54187 10.6866 9.49469C10.663 9.44751 10.6394 9.40033 10.6158 9.35315C10.5922 9.30597 10.5686 9.2352 10.5686 9.18801C10.545 9.14083 10.545 9.07006 10.545 9.02288C10.545 8.81056 10.6394 8.59825 10.781 8.43311C10.8045 8.40952 10.8517 8.36234 10.8989 8.33875L11.0405 8.26798C11.1112 8.24438 11.1584 8.22079 11.2056 8.22079ZM13.14 8.43311C13.4467 8.12643 14.0129 8.12643 14.3196 8.43311C14.4611 8.59825 14.5555 8.81056 14.5555 9.02288C14.5555 9.07006 14.5319 9.14083 14.5319 9.18801L14.5249 9.2518C14.5162 9.29024 14.5004 9.32169 14.4847 9.35315C14.4611 9.40033 14.4375 9.44751 14.4139 9.49469C14.3903 9.54187 14.3667 9.56547 14.3196 9.61265C14.1544 9.75419 13.9657 9.84855 13.7298 9.84855C13.4939 9.84855 13.2816 9.77778 13.14 9.61265C13.1164 9.58906 13.0693 9.54187 13.0457 9.49469C13.0221 9.44751 12.9985 9.40033 12.9749 9.35315C12.9513 9.30597 12.9277 9.2352 12.9277 9.18801C12.9041 9.14083 12.9041 9.07006 12.9041 9.02288C12.9041 8.81056 12.9985 8.59825 13.14 8.43311ZM14.815 1.8513H3.18475C2.33548 1.8513 1.65135 2.53543 1.65135 3.3847V4.94169H16.3484V3.3847C16.3484 2.53543 15.6642 1.8513 14.815 1.8513Z" fill="#BAC0D9"/>
                                                    </svg>
                                                    <svg *ngIf="service?.name == type.humidity" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                        <path fill-rule="evenodd" clip-rule="evenodd" d="M11.7948 1.5L12.2866 1.78664C12.6254 1.97883 20.5896 6.70847 20.5896 13.7052C20.5896 16.0377 19.663 18.2747 18.0136 19.9241C16.3643 21.5734 14.1273 22.5 11.7948 22.5C9.46227 22.5 7.22528 21.5734 5.57593 19.9241C3.92659 18.2747 3 16.0377 3 13.7052C3 6.70847 10.9642 1.97883 11.3029 1.78664L11.7948 1.5ZM6.9579 18.5421C8.24072 19.8249 9.9806 20.5456 11.7948 20.5456C13.609 20.5456 15.3489 19.8249 16.6317 18.5421C17.9145 17.2593 18.6352 15.5194 18.6352 13.7052C18.6352 8.72801 13.4397 4.88111 11.7948 3.78664C10.1661 4.88436 4.9544 8.74104 4.9544 13.7052C4.9544 15.5194 5.67508 17.2593 6.9579 18.5421ZM9.84039 12.728V13.7052C9.84039 14.2235 10.0463 14.7207 10.4128 15.0872C10.7793 15.4537 11.2764 15.6596 11.7948 15.6596H12.772V17.614H11.7948C10.7581 17.614 9.76389 17.2022 9.03085 16.4691C8.29781 15.7361 7.88599 14.7419 7.88599 13.7052V12.728H9.84039Z" fill="#BAC0D9"/>
                                                    </svg>
                                                    <svg *ngIf="service?.name == type.weather" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                        <path d="M17.9632 12.3764C17.6403 11.5476 17.149 10.7949 16.5204 10.1657C15.8918 9.5365 15.1395 9.04454 14.3111 8.7209C14.3441 8.46384 14.361 8.20497 14.3618 7.9458C14.3644 6.8515 14.0876 5.77465 13.5578 4.81717C13.0279 3.85969 12.2625 3.05325 11.334 2.47418C10.4054 1.89511 9.34449 1.56256 8.25154 1.508C7.1586 1.45344 6.06981 1.67868 5.08822 2.16241C4.10663 2.64613 3.26472 3.37233 2.64215 4.27229C2.01959 5.17224 1.63697 6.21618 1.53051 7.30529C1.42405 8.39441 1.59727 9.49267 2.03377 10.4962C2.47028 11.4996 3.15563 12.3751 4.02497 13.0398C3.06282 13.6022 2.31245 14.4655 1.8896 15.4966C1.46675 16.5277 1.39492 17.6693 1.68519 18.7453C1.97545 19.8213 2.61169 20.7719 3.49575 21.4504C4.37981 22.129 5.46258 22.4978 6.57703 22.5H17.4081C18.7064 22.4999 19.9554 22.0025 20.8983 21.1099C21.8411 20.2172 22.4062 18.9973 22.4773 17.7009C22.5483 16.4045 22.1201 15.1301 21.2804 14.1398C20.4408 13.1494 19.2537 12.5184 17.9632 12.3764ZM7.93091 3.54569C9.09789 3.54569 10.2171 4.00928 11.0423 4.83446C11.8674 5.65964 12.331 6.77882 12.331 7.9458C12.331 8.06314 12.331 8.17596 12.331 8.28427C12.2227 8.28427 12.1144 8.28427 11.9925 8.28427C10.7754 8.28852 9.58445 8.6381 8.55811 9.29237C7.53176 9.94664 6.71216 10.8787 6.19456 11.9804C5.26882 11.5775 4.50978 10.8685 4.04478 9.97237C3.57977 9.07623 3.43708 8.04743 3.64065 7.05856C3.84422 6.06969 4.38166 5.18091 5.16281 4.5413C5.94396 3.90169 6.92131 3.55016 7.93091 3.54569ZM17.4081 20.4692H6.57703C5.76912 20.4692 4.9943 20.1482 4.42302 19.577C3.85174 19.0057 3.5308 18.2309 3.5308 17.423C3.5308 16.615 3.85174 15.8402 4.42302 15.2689C4.9943 14.6977 5.76912 14.3767 6.57703 14.3767H7.55521L7.75152 13.6152C7.99159 12.6726 8.53885 11.8368 9.30686 11.2399C10.0749 10.6429 11.0198 10.3189 11.9925 10.3189C12.9652 10.3189 13.9102 10.6429 14.6782 11.2399C15.4462 11.8368 15.9935 12.6726 16.2336 13.6152L16.4299 14.3767H17.4081C18.216 14.3767 18.9908 14.6977 19.5621 15.2689C20.1333 15.8402 20.4543 16.615 20.4543 17.423C20.4543 18.2309 20.1333 19.0057 19.5621 19.577C18.9908 20.1482 18.216 20.4692 17.4081 20.4692Z" fill="#BAC0D9"/>
                                                    </svg>
                                                    <svg *ngIf="service?.name == type.animation" width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                        <path d="M19.5476 0.828186C19.5476 1.04368 19.5052 1.25706 19.4227 1.45614C19.3402 1.65523 19.2194 1.83612 19.067 1.9885C18.9146 2.14087 18.7337 2.26174 18.5346 2.34421C18.3356 2.42667 18.1222 2.46912 17.9067 2.46912H9.7447C7.50237 2.5334 5.35482 3.38765 3.68101 4.88114C2.0072 6.37463 0.914719 8.41135 0.596355 10.6319C0.277992 12.8524 0.754209 15.114 1.94097 17.0177C3.12773 18.9213 4.94875 20.3445 7.08269 21.0362C9.21663 21.7279 11.5263 21.6437 13.6042 20.7983C15.682 19.9529 17.3945 18.4007 18.4393 16.4157C19.4842 14.4306 19.7943 12.1403 19.315 9.94888C18.8356 7.75745 17.5976 5.80576 15.8194 4.43823H17.9067C18.3808 4.43823 18.8502 4.34486 19.2882 4.16343C19.7262 3.98201 20.1241 3.7161 20.4594 3.38087C20.7946 3.04565 21.0605 2.64768 21.2419 2.20969C21.4234 1.7717 21.5167 1.30226 21.5167 0.828186V0.5H19.5476V0.828186ZM9.04566 4.50387V7.83496C8.44613 7.9753 7.88551 8.24776 7.40473 8.63245L4.79893 6.55503C5.95816 5.43394 7.44687 4.7149 9.04566 4.50387ZM9.4362 14.205C8.89832 14.0605 8.43129 13.7254 8.12201 13.2622C7.81273 12.7989 7.68227 12.2391 7.75491 11.6869C7.82755 11.1347 8.09834 10.6277 8.51689 10.2602C8.93544 9.89269 9.47324 9.68979 10.0302 9.68921C10.2319 9.68932 10.4327 9.7158 10.6275 9.76797C10.925 9.84029 11.2051 9.97134 11.4512 10.1534C11.6973 10.3355 11.9046 10.565 12.0608 10.8283C12.217 11.0916 12.319 11.3835 12.3607 11.6868C12.4025 11.9901 12.3832 12.2987 12.304 12.5945C12.2249 12.8902 12.0874 13.1671 11.8996 13.409C11.7119 13.6508 11.4777 13.8527 11.2108 14.0028C10.9439 14.1528 10.6498 14.248 10.3456 14.2827C10.0414 14.3175 9.73332 14.2911 9.43949 14.205H9.4362ZM12.6623 8.62589C12.2093 8.27041 11.6891 8.01029 11.1329 7.86121L11.0148 7.83824V4.50387C12.6136 4.7149 14.1023 5.43394 15.2615 6.55503L12.6623 8.62589ZM2.48194 11.9865C2.48063 10.613 2.85638 9.26555 3.56824 8.09094L6.17403 10.1684C5.91098 10.7261 5.77107 11.3338 5.7638 11.9504L2.51476 12.6921C2.48194 12.4591 2.48194 12.2261 2.48194 11.9865ZM2.95453 14.612L6.20685 13.8703C6.24952 13.9556 6.2889 14.0377 6.33485 14.1197C6.59592 14.5707 6.9374 14.97 7.34238 15.2979L5.89836 18.2975C4.55045 17.413 3.51933 16.1221 2.95453 14.612ZM10.0302 19.5348C9.2284 19.5346 8.43177 19.4061 7.67056 19.1541L9.11786 16.1446C9.41722 16.2133 9.7231 16.2496 10.0302 16.2529C10.3351 16.2508 10.6388 16.2156 10.936 16.1479L12.3833 19.1541C11.6242 19.4054 10.8298 19.5339 10.0302 19.5348ZM14.1621 18.2975L12.7148 15.2946C13.1932 14.9081 13.5818 14.4221 13.8536 13.8703L17.1059 14.612C16.5411 16.1221 15.51 17.413 14.1621 18.2975ZM17.5785 11.9865C17.5785 12.2261 17.5785 12.4591 17.5457 12.6921L14.2966 11.9504C14.292 11.3349 14.1531 10.7279 13.8897 10.1716L16.4955 8.09422C17.2056 9.26821 17.5802 10.6145 17.5785 11.9865Z" fill="#BAC0D9"/>
                                                    </svg>
                                                    <svg *ngIf="service?.name == type.saints" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                        <path fill-rule="evenodd" clip-rule="evenodd" d="M20.923 7.125C20.974 7.49572 21 7.87152 21 8.25H18.75C18.9375 7.83873 18.9375 7.58049 18.9375 7.01925V6L20.6873 6C20.7471 6.21104 20.7986 6.4247 20.8415 6.64049C20.8734 6.80089 20.9006 6.96245 20.923 7.125ZM6.5625 7.01925C6.5625 7.5 6.5625 7.6377 6.75 8.25H4.5C4.5 7.87152 4.52601 7.49572 4.57703 7.125C4.5994 6.96246 4.62658 6.80089 4.65849 6.64049C4.70142 6.4247 4.7529 6.21104 4.81273 6H6.5625V7.01925ZM7.76117 4.91654L5.89035 3.66653C6.18842 3.22042 6.53141 2.80133 6.91637 2.41637C7.30133 2.03141 7.72042 1.68842 8.16653 1.39035L9.41654 3.26117C9.09218 3.47789 8.78743 3.72729 8.50736 4.00736C8.22729 4.28743 7.97789 4.59218 7.76117 4.91654ZM11.5795 2.36525L11.1405 0.15849C11.6667 0.0538117 12.2056 0 12.75 0C13.2944 0 13.8333 0.0538116 14.3595 0.158489L13.9205 2.36525C13.5379 2.28914 13.1461 2.25 12.75 2.25C12.3539 2.25 11.9621 2.28914 11.5795 2.36525ZM16.0835 3.26117L17.3335 1.39035C17.7796 1.68842 18.1987 2.0314 18.5836 2.41637C18.9686 2.80133 19.3116 3.22042 19.6097 3.66653L17.7388 4.91654C17.5221 4.59218 17.2727 4.28742 16.9926 4.00736C16.7126 3.72729 16.4078 3.47789 16.0835 3.26117ZM20.7 22.5H4.5V20.4C4.5 18.039 5.751 16.218 8.217 15C8.58652 14.8117 8.96959 14.6513 9.363 14.52C8.55264 13.6836 8.09967 12.5646 8.1 11.4V9C8.1 7.80653 8.57411 6.66193 9.41802 5.81802C10.2619 4.97411 11.4065 4.5 12.6 4.5C13.7935 4.5 14.9381 4.97411 15.782 5.81802C16.6259 6.66193 17.1 7.80653 17.1 9V11.4C17.1042 12.5698 16.651 13.6949 15.837 14.535C16.23 14.6614 16.613 14.8168 16.983 15C19.449 16.218 20.7 18.039 20.7 20.4V22.5ZM10.6908 7.09081C10.1845 7.59716 9.9 8.28392 9.9 9V11.4C9.9 12.1161 10.1845 12.8028 10.6908 13.3092C11.1972 13.8155 11.8839 14.1 12.6 14.1C13.3161 14.1 14.0028 13.8155 14.5092 13.3092C15.0155 12.8028 15.3 12.1161 15.3 11.4V9C15.3 8.28392 15.0155 7.59716 14.5092 7.09081C14.0028 6.58446 13.3161 6.3 12.6 6.3C11.8839 6.3 11.1972 6.58446 10.6908 7.09081ZM9.024 16.596C7.164 17.523 6.3 18.732 6.3 20.4V20.7H18.9V20.4C18.9 18.732 18.036 17.523 16.176 16.596C15.2621 16.1393 14.2546 15.9011 13.233 15.9H11.967C10.9454 15.9011 9.93791 16.1393 9.024 16.596Z" fill="#BAC0D9"/>
                                                    </svg>
                                                </div>
                                            </div>
                                            <div class="p-2" style="background-color: #F5F6FA; border-bottom-left-radius: 8px; border-bottom-right-radius: 8px;">
                                                <div class="form-check form-switch" *ngIf="service.online">
                                                    <input class="form-check-input service-check" type="checkbox" [value]="service._id" (change)="onServiceCheckboxChange('online_services', $event)" [checked]="isServiceChecked('online_services', service)">
                                                    <label class="form-check-label" for="{{service._id}}">
                                                        <span [hidden]="!isServiceChecked('online_services', service)" i18n>Online activo</span>
                                                        <span [hidden]="isServiceChecked('online_services', service)" i18n>Online inactivo</span>
                                                    </label>
                                                </div>
                                                <div class="form-check form-switch" *ngIf="service.offline">
                                                    <input class="form-check-input service-check" type="checkbox" [value]="service._id" (change)="onServiceCheckboxChange('offline_services', $event)" [checked]="isServiceChecked('offline_services', service)">
                                                    <label class="form-check-label" for="{{service._id}}">
                                                        <span [hidden]="!isServiceChecked('offline_services', service)" i18n>Offline activo</span>
                                                        <span [hidden]="isServiceChecked('offline_services', service)" i18n>Offline inactivo</span>
                                                    </label>
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                </div>
        
                                <button class="mt-1 btn btn-lg btn-outline-primary me-2" (click)="previousCurrentWizard()" i18n>Atrás</button>
                                <button class="mt-1 btn btn-lg btn-primary" type="submit" i18n>Continuar</button>                         
                            </div>

                            <div *ngIf="currentWizardNumber === 2">
                                <h5 i18n>Secuencias</h5>
                                <p class="fs-10" i18n>Configura las secuencias por defecto que estarán disponibles en el panel o la cruz.</p>
                                
                                <div class="row">
                                    <div class="col-8 col-sm-8 col-md-8	col-lg-8 col-xl-8 col-xxl-8 mt-4">
                                        <h4 class="fs-10 lh-3 fw-bold" i18n>Secuencias por defecto ({{ sequencesCount }})</h4>
                                    </div>
                                    <div class="col-4 col-sm-4 col-md-4	col-lg-10 col-xl-4 col-xxl-4 text-end mt-2">
                                        <button type="button" class="btn btn-outline-primary" (click)="openAddModelSequenceModal(addModelSequenceModal)">
                                            <svg class="me-2" width="12" height="12" viewBox="0 0 12 12" fill="none"
                                                xmlns="http://www.w3.org/2000/svg">
                                                <path fill-rule="evenodd" clip-rule="evenodd"
                                                    d="M10.6667 5.33335H6.66675V1.33335C6.66675 0.965164 6.36827 0.666687 6.00008 0.666687C5.63189 0.666687 5.33341 0.965164 5.33341 1.33335V5.33335H1.33341C0.965225 5.33335 0.666748 5.63183 0.666748 6.00002C0.666748 6.36821 0.965225 6.66669 1.33341 6.66669H5.33341V10.6667C5.33341 11.0349 5.63189 11.3334 6.00008 11.3334C6.36827 11.3334 6.66675 11.0349 6.66675 10.6667V6.66669H10.6667C11.0349 6.66669 11.3334 6.36821 11.3334 6.00002C11.3334 5.63183 11.0349 5.33335 10.6667 5.33335Z"
                                                    fill="#2C2A86" />
                                            </svg>
                                            <span i18n>Nueva secuencia</span>
                                        </button>
                                    </div>
                                </div>

                                <div class="row mt-2 mb-2" *ngFor="let modelSequence of modelSequencesForm.value;">
                                    <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12 col-xxl-12">
                                        <span class="text-secondary fw-bold">{{ modelSequence.name }}</span>
                                        <hr>
                                    </div>

                                    <div class="row">
                                        <!-- start: Add new sequence button -->
                                        <div class="col-2 col-sm-2 col-md-2	col-lg-2 col-xl-2 col-xxl-2 mb-2 align-self-stretch">
                                            <div class="border rounded border-dashed cursor-pointer bg-light d-flex h-100" (click)="openAddModelSequenceModal(addModelSequenceModal, modelSequence.category)">
                                                <span class="m-auto"><i class="bi bi-plus-lg"></i></span>
                                            </div>
                                        </div>
                                        <!-- end: Add new sequence button -->

                                        <!-- start: List of sequence by category -->
                                        <div class="col-10">
                                            <div class="row h-100">
                                                <div class="col-4 col-sm-4 col-md-4	col-lg-4 col-xl-4 col-xxl-4 mb-2 align-self-stretch" *ngFor="let sequence of modelSequence.list">
                                                    <div class="border-start border-primary border-4 rounded p-2 cursor-pointer h-100 bg-white shadow-lg secuence-card"
                                                    [ngClass]="{'border-primary': sequence.category === 'daily', 'border-fest' : sequence.category === 'holiday', 'border-guard' : sequence.category === 'on_guard' }"
                                                    (click)="openEditModelSequenceModal(editModelSequenceModal, sequence)">
                                                        <div class="row">
                                                            <div class="col-9">
                                                                <span class="text-primary fw-bold d-block text-truncate">{{ sequence.name }}</span>
                                                                <p class="text-secondary">Tipo: {{ modelSequence.name }}<br>
                                                                    <span *ngIf="sequence.default" class="text-secondary" i18n>Predeterminada</span>
                                                                </p>
                                                            </div>
                                                            <div class="col-3">
                                                                <div class="btn-group dropdown float-end">
                                                                    <a data-bs-toggle="dropdown" aria-expanded="false" (click)="$event.stopPropagation()">
                                                                        <div class="btn btn-outline-primary"><i class="bi bi-three-dots-vertical"></i></div>
                                                                    </a>
                                                                    <ul class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                                                                        <li>
                                                                            <button type="button" class="dropdown-item cursor-pointer" (click)="deleteSequence(sequence, $event)" i18n>Eliminar</button>
                                                                        </li>
                                                                    </ul>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                </div>

                                <button class="mt-1 btn btn-lg btn-outline-primary me-2" (click)="previousCurrentWizard()" i18n>Atrás</button>
                                <button class="mt-1 btn btn-lg btn-primary" type="submit" i18n>Continuar</button>
                            </div>
                        </form>
                        <div class="text-center" *ngIf="currentWizardNumber === 3">
                            <p ><i class="bi bi-check2 h1 text-success"></i></p>
                            <p class="fs-10 mb-4 mt-4" i18n>¡Perfecto! Has añadido el modelo {{ productModel?.name }}.</p>

                            <button type="button" class="btn btn-lg btn-primary w-50 mt-4" [routerLink]="['/product-models', productModel?._id ]" *ngIf="!this.modelId" i18n>Ver modelo</button>
                            <button type="button" class="btn btn-lg btn-primary w-50 mt-4" (click)="reloadComponent()" *ngIf="this.modelId" i18n>Ver modelo</button>

                            <p class="mt-5" i18n>O si lo prefieres puedes:</p>
                            <button type="button" class="btn btn-lg btn-primary w-50" [routerLink]="['/product-models']" i18n>Volver al listado de modelos</button>
                        </div>
                    </div>
                </div>
                <div class="col-md-3"></div>
            </div>
        </main>
    </div>
</div>

<!-- start: Modal for edit service attributes -->
<ng-template #editServiceModal let-modal>
    <form #modelNgForm="ngForm" [formGroup]="getModelAttributeForm()" (ngSubmit)="validateForm()"> <!--(ngSubmit)="modal.dismiss('Save button click')"-->
        <div class="modal-header">
            <h6 class="modal-title" id="modal-basic-title" i18n>Editar opciones: {{ service?.name | typeAbbreviation }}</h6>
        </div>
        <div class="modal-body">
            <div class="row ps-2 pe-2">
                <ng-container *ngFor="let attribute of getModelAttributeForm().get('attributes')['controls']; let i = index;" formArrayName="attributes">
                    <ng-container *ngIf="attribute.value.type != 'row' && attribute.value.type != 'message' && attribute.value.type != 'path' && attribute.value.type != 'img'">
                        <h6>{{ attribute.value.name }}</h6>
                        <div class="row mb-5">
                            <div class="col-12 col-sm-12 col-md-3 col-lg-3 col-xl-3 col-xxl-3">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" [checked]="true" id="{{ attribute.value.id_attribute + '_all' }}" (change)="toggleAttributeOptions(attribute.value.type, $event);">
                                    <label class="form-check-label" for="{{ attribute.value.id_attribute + '_all' }}" i18n>Marcar / Desmarcar todas</label>
                                </div>
                            </div>
                            <div class="col-12 col-sm-12 col-md-3 col-lg-3 col-xl-3 col-xxl-3" *ngFor="let option of attribute.get('available_options')['controls']">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" [value]="option.value.id" id="{{ attribute.value.id_attribute + '_' + option.value.id }}" [formControl]="option.get('checked')" [disabled]>
                                    <label class="form-check-label" for="{{ attribute.value.id_attribute + '_' + option.value.id }}">{{ option.value.name }}</label>
                                </div>
                            </div>
                        </div>
                    </ng-container>
                    <div class="row mb-5" *ngIf="attribute.value.type == 'row'">
                        <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12 col-xxl-12">
                            <p i18n>Las filas disponibles para los models dependeran de la altura de la cruz/rótulo y de la fuente seleccionada por el usuario.</p>
                        </div> 
                    </div>
                </ng-container>
            </div>
        </div>
        <div class="modal-footer bg-body">
            <button type="button" class="btn btn-outline-primary me-auto" (click)="cancelEditService()" i18n>Cancelar</button>
            <button type="submit" class="btn btn-primary text-light" i18n>Guardar</button>
        </div>
    </form>
</ng-template>
<!-- end: Modal for edit service attributes -->

<!-- start: Modal for adding new sequence -->
<ng-template #addModelSequenceModal let-modal>
    <div class="modal-header">
        <h4 class="modal-title " id="modal-basic-title" i18n>Crear secuencia</h4>
        <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
    </div>
    <form [formGroup]="modelSingleSequenceForm" (ngSubmit)="submitModelSequenceForm()">
        <div class="modal-body">
            <div class="mb-3">
                <label for="formCategory" class="form-label" i18n>Tipo</label>
                <select id="formCategory" class="form-select" formControlName="category">
                    <option *ngFor="let category of categories" [value]="category.id">{{ category.name }}</option>
                </select>
            </div>
            <div class="mb-3">
                <label for="formName" class="form-label" i18n>Nombre</label>
                <input type="text" class="form-control" id="formName" placeholder="Ej.: Buenos días" formControlName="name">
            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-outline-primary me-auto" (click)="modal.dismiss('Close button click')" i18n>Cerrar</button>
            <button type="submit" class="btn btn-primary" [disabled]="!modelSingleSequenceForm.valid" i18n>Crear secuencia</button>
        </div>
    </form>
</ng-template>
<!-- end: Modal for adding new sequence -->

<!-- start: Modal for editing  sequence -->
<ng-template #editModelSequenceModal let-modal>
    <div class="modal-header">
        <h4 class="modal-title " id="modal-basic-title" i18n>Editar secuencia</h4>
    </div>
    
    <div class="modal-body bg-body">
        <div class="row  pt-2 ps-2">
            <div class="col-md-12 col-lg-12 ps-5 pe-5">
                <div class="row mb-4">
                    <div class="col-8 col-sm-8 col-md-8	col-lg-8 col-xl-8 col-xxl-8">
                        <h4 class="fs-10 fw-bold" i18n>Acciones de la secuencia ({{ modelSingleSequenceForm?.get('actions')?.length }})</h4>
                    </div>
                    <div class="col-4 col-sm-4 col-md-4	col-lg-4 col-xl-4 col-xxl-4 text-end mt-2">
                        <button type="button" class="btn btn-primary me-2" (click)="openSequenceSimulatorModal(sequenceSimulatorModal)" [disabled]="modelSingleSequenceForm?.get('actions')?.length == 0">Simular secuencia</button>
                        <button type="button" class="btn btn-outline-primary" (click)="openAddActionModal(addActionModal)">
                            <svg class="me-2" width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M10.6667 5.33335H6.66675V1.33335C6.66675 0.965164 6.36827 0.666687 6.00008 0.666687C5.63189 0.666687 5.33341 0.965164 5.33341 1.33335V5.33335H1.33341C0.965225 5.33335 0.666748 5.63183 0.666748 6.00002C0.666748 6.36821 0.965225 6.66669 1.33341 6.66669H5.33341V10.6667C5.33341 11.0349 5.63189 11.3334 6.00008 11.3334C6.36827 11.3334 6.66675 11.0349 6.66675 10.6667V6.66669H10.6667C11.0349 6.66669 11.3334 6.36821 11.3334 6.00002C11.3334 5.63183 11.0349 5.33335 10.6667 5.33335Z" fill="#2C2A86"/>
                            </svg>
                            <span i18n>Añadir acción</span>
                        </button>
                    </div>
                    <hr>
                </div>
                <form [formGroup]="modelSingleSequenceForm">
                    <div cdkDropList (cdkDropListDropped)="dropAction($event)">
                        <div cdkDrag [cdkDragData]="action" *ngFor="let action of modelSingleSequenceForm.get('actions')['controls']; let i = index;" formArrayName="actions">
                            <div class="row mt-2 mb-2 ps-1 pe-3" [formGroupName]="i">
                                <div class="col-1 col-sm-1 col-md-1	col-lg-1 col-xl-1 col-xxl-1 my-auto">
                                    <div class="circle bg-enum mt-0 mx-auto">
                                        <span class="m-auto fs-12 fw-bold text-info">{{ i+1 }}</span>
                                    </div>
                                </div>
                                <div class="col-11 col-sm-11 col-md-11 col-lg-11 col-xl-11 col-xxl-11 bg-white shadow-lg rounded">
                                    <div class="accordion-item" style="border: none">
                                        <h2 class="accordion-header" id="panelsStayOpen-heading{{i}}">
                                            <button id="accordion_{{i}}" class="accordion-button p-0" type="button" data-bs-toggle="collapse" [attr.data-bs-target]="'#panelsStayOpen-collapse' + i" aria-expanded="false" [attr.aria-controls]="'panelsStayOpen-collapse' + i">
                                                <div class="col-10 col-sm-10 col-md-10 col-lg-10 col-xl-10 col-xxl-10 my-auto">
                                                    <i class="bi bi-grip-vertical me-2 text-primary fs-10"></i>
                                                    <span class="my-auto ps-2 fs-11 fw-bold">{{ action.value.type | typeAbbreviation }}</span>
                                                </div>
                                                <div class="col-2 col-sm-2 col-md-2	col-lg-2 col-xl-2 col-xxl-2 text-end me-3">
                                                    <button type="button" class="btn btn-primary me-2 text-end" (mouseenter)="preventAccordion(i)" (mouseleave)="activeAccordion(i)" (click)="$event.preventDefault();openEditActionModal(editActionModal, i)" i18n>Editar</button>
                                                    <div class="btn-group dropdown">
                                                        <a data-bs-toggle="dropdown" aria-expanded="false" (mouseenter)="preventAccordion(i)" (mouseleave)="activeAccordion(i)">
                                                            <div class="btn btn-outline-primary float-end"><i class="bi bi-three-dots-vertical"></i></div>
                                                        </a>
                                                        <ul class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                                                            <li>
                                                                <button class="dropdown-item cursor-pointer" (click)="deleteAction(i)" i18n>Eliminar</button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </button>
                                        </h2>
                                        <div id="panelsStayOpen-collapse{{i}}" class="accordion-collapse collapse" [attr.aria-labelledby]="'panelsStayOpen-heading' + i">
                                            <div class="accordion-body pt-0 pb-4">
                                                <p class="my-auto ps-4 fs-11 text-secondary" *ngFor="let parameter of action.value.parameters | keyvalue;">{{ findAttributeName(action.value.type, parameter.key) }}: {{ findAttributeOptionName(action.value.type, parameter.key, parameter.value) }}</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-outline-primary me-auto" (click)="closeSequenceModal()" i18n>Cerrar</button>
        <button type="button" class="btn btn-primary" [disabled]="!modelSingleSequenceForm.valid" (click)="submitModelSequenceForm(true)" [disabled]="modelSingleSequenceForm?.get('actions')?.length <= 0" i18n>Editar secuencia</button>
    </div>
</ng-template>

<!-- start: Modal for adding new action -->
<ng-template #addActionModal let-modal>
    <div class="modal-header">
      <h4 class="modal-title" id="modal-basic-title" i18n>Añadir acción</h4>
    </div>
    <form [formGroup]="actionForm" (submit)="pushActionToFormSequence()">
      <div class="modal-body">
        <div class="row">
            <div class="col-6 col-sm-6 col-md-6	col-lg-6 col-xl-6 col-xxl-6" *ngFor="let modelAttribute of modelAttributesForm.value">
                <div class="form-check ms-1 mt-1 mb-1">
                    <input class="form-check-input" type="radio" name="type" id="{{ modelAttribute.type }}" [value]="modelAttribute.type" formControlName="type">
                    <label class="form-check-label" for="{{ modelAttribute.type }}"> {{ modelAttribute.type | typeAbbreviation }}</label>
                </div>
            </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-outline-primary me-auto" (click)="modal.dismiss('Close button click')" i18n>Cerrar</button>
        <button type="submit" class="btn btn-primary" i18n>Añadir acción</button>
      </div>
    </form>
</ng-template>
<!-- end: Modal for adding new action -->

<!-- start: Modal for sequence simulator -->
<ng-template #sequenceSimulatorModal let-modal>
    <div class="modal-header">
        <h4 class="modal-title" id="modal-basic-title" i18n>Simulador de secuencias</h4>
    </div>
    <div class="modal-body">
        <tecneplas-sequence-simulator></tecneplas-sequence-simulator>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-outline-primary me-auto" (click)="modal.dismiss('Close button click')" i18n>Cerrar</button>
    </div>
</ng-template>
<!-- end: Modal for sequence simulator -->

<!-- start: Modal for edit new action -->
<ng-template #editActionModal let-modal>
    <div class="modal-header">
      <h4 class="modal-title" id="modal-basic-title" i18n>Editar acción</h4>
    </div>
    <form [formGroup]="actionForm" (submit)="submitFormAction()">
        <div class="modal-body" formArrayName="parameters">
            <div class="row">
                <ng-container *ngFor="let attribute of actionForm.get('available_attributes').value">

                    <div class="col-3 col-sm-3 col-md-3	col-lg-3 col-xl-3 col-xxl-3 mb-3" *ngIf="attribute.type !== 'img' && attribute.type !== 'other' && attribute.type !== 'message' && attribute.type !== 'path'">
                        <label for="{{ attribute.type }}" class="form-label" i18n>{{ attribute.name }}
                            <i class="bi bi-question-circle cursor-pointer" style="padding-left: 4px;" *ngIf="attribute.type == 'row'" (click)="showHelpModal()"></i>
                        </label>
                        <select *ngIf="attribute.type == 'font_size'" class="form-select" id="{{ attribute.type }}" formControlName="{{ attribute.type }}" (change)="calculateRowsAvailable()">
                            <ng-container *ngFor="let option of attribute.available_options">
                                <option *ngIf="option.checked" [value]="option.id">{{ option.name }}</option>
                            </ng-container>
                        </select>
                        <select *ngIf="attribute.type != 'row' && attribute.type != 'font_size'" class="form-select" id="{{ attribute.type }}" formControlName="{{ attribute.type }}">
                            <ng-container *ngFor="let option of attribute.available_options">
                                <option *ngIf="option.checked" [value]="option.id">{{ option.name }}</option>
                            </ng-container>
                        </select>              
                        <select *ngIf="attribute.type == 'row'" class="form-select" id="{{ attribute.type }}" formControlName="{{ attribute.type }}">
                            <option *ngFor="let param of availableRows" [value]="param.id">{{ param.name }}</option>
                        </select>
                    </div>

                    <div class="col-12" *ngIf="attribute.type == 'other'">
                        <div class="row" *ngIf="checkOtherOptions(attribute.available_options)">
                            <label for="{{ attribute.type }}" class="form-label" i18n>Otros</label>
                            <div class="col-3 col-sm-3 col-md-3 col-lg-3 col-xl-3 col-xxl-3 mb-3" *ngFor="let option of attribute.available_options">
                                <div class="form-check" *ngIf="option.checked">
                                    <input class="form-check-input" type="checkbox" id="{{ option.id }}" formControlName="{{ option.id }}">
                                    <label class="form-check-label" for="{{ option.id }}" i18n>{{ option.name }}</label>  
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-12" *ngIf="attribute.type == 'message'">
                        <label for="formText" class="form-label" i18n>Texto</label>
                        <input type="text" class="form-control" id="formText" placeholder="Ej.: Buenos días" formControlName="{{ attribute.type }}">
                    </div>

                    <div class="col-9" *ngIf="attribute.type == 'img'">
                        <label for="formImg" class="form-label" i18n>Imagen</label>
                        <input class="form-control" type="file" accept="image/png, image/jpeg" id="formImg" (change)="onChangeImageFile($event)">
                        <img id="uploadedImg" [src]="actionForm.get('parameters').get('img').value" style="margin-top: 10px; max-height: 200px;">
                        <canvas id="canvas" width="56" height="56" style="display: none; visibility: hidden;"></canvas>
                        <input class="w-100" type="text" formControlName="{{ attribute.type }}" readonly hidden>
                    </div>

                </ng-container>

            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-outline-primary me-auto" (click)="cancelEditActionModal()" i18n>Cerrar</button>
            <button type="submit" class="btn btn-primary" i18n>Editar acción</button>
          </div>
    </form>
</ng-template>

<!-- start: Modal for Showing rows -->
<ng-template #showRowsModal let-modal>
    <div class="modal-header">
        <h4 class="modal-title " id="modal-basic-title" i18n>Filas</h4>
    </div>
    <div class="modal-body">
        <div class="mb-3">
            <div class="row border">
                <div class="col" *ngFor="let num of helpTable" style="padding-top: 0 !important">
                    <div class="row d-flex h-100">
                        <div class="d-flex border" *ngFor="let col of num"><span class="my-auto">{{col}}</span></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-outline-primary" (click)="modal.dismiss('Close button click')"i18n>Cerrar</button>
    </div>
</ng-template>
<!-- end: Modal for Showing rows -->